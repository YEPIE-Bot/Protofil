<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Snake Game | Premium UI</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap');

  :root {
    --bg-dark: #121212;
    --bg-light: #f9f9f9;
    --snake-color-dark: #4a90e2;
    --food-color-dark: #e74c3c;
    --snake-color-light: #2c3e50;
    --food-color-light: #c0392b;
    --board-bg-dark: #1e1e1e;
    --board-bg-light: #ddd;
    --text-light: #f0f0f0;
    --text-dark: #222;
    --border-radius: 12px;
    --transition-speed: 0.3s;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: 'Poppins', sans-serif;
    background: var(--bg-dark);
    color: var(--text-light);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    padding: 2rem;
    transition: background-color var(--transition-speed);
    -webkit-tap-highlight-color: transparent;
    -webkit-user-select: none;
       -moz-user-select: none;
        -ms-user-select: none;
            user-select: none;
  }

  body.light {
    background: var(--bg-light);
    color: var(--text-dark);
  }

  h1 {
    font-weight: 700;
    margin-bottom: 1.5rem;
    font-size: 2.5rem;
    user-select: none;
  }

  .game-container {
    background: var(--board-bg-dark);
    border-radius: var(--border-radius);
    padding: 1.5rem;
    box-shadow: 0 10px 25px rgba(0,0,0,0.5);
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 320px;
  }

  body.light .game-container {
    background: var(--board-bg-light);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  }

  canvas {
    background: #000;
    border-radius: var(--border-radius);
    box-shadow: inset 0 0 15px #222;
    display: block;
    touch-action: none; /* prevent default gestures */
  }

  .score {
    margin-top: 1rem;
    font-size: 1.3rem;
    font-weight: 600;
    user-select: none;
  }

  button {
    margin-top: 1.5rem;
    padding: 0.7rem 1.4rem;
    background-color: #4a90e2;
    border: none;
    border-radius: var(--border-radius);
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background-color var(--transition-speed);
    user-select: none;
    width: 100%;
    font-size: 1.1rem;
  }

  button:hover {
    background-color: #367adf;
  }

  .instructions {
    margin-top: 1rem;
    font-size: 0.9rem;
    color: #aaa;
    text-align: center;
    user-select: none;
  }

  .toggle-theme {
    position: fixed;
    top: 1.5rem;
    right: 1.5rem;
    background: #4a90e2;
    border: none;
    border-radius: 50%;
    width: 45px;
    height: 45px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 5px 15px rgba(58,123,213,0.5);
    transition: background-color var(--transition-speed);
  }

  .toggle-theme:hover {
    background: #367adf;
  }

  .toggle-theme svg {
    fill: white;
    width: 24px;
    height: 24px;
  }

  @media (max-width: 400px) {
    .game-container {
      width: 90vw;
    }
    canvas {
      width: 100% !important;
      height: auto !important;
    }
  }
</style>
</head>
<body>

<button class="toggle-theme" aria-label="Toggle Light/Dark Mode" title="Toggle Light/Dark Mode">
  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
    <path d="M12 2a9.93 9.93 0 0 0-3.687.67 7.98 7.98 0 1 0 9.718 9.72A9.93 9.93 0 0 0 12 2zm0 16a7 7 0 1 1 0-14 7 7 0 0 1 0 14z"/>
  </svg>
</button>

<h1>Snake Game</h1>
<div class="game-container" role="main" aria-label="Snake game">
  <canvas id="game" width="320" height="320" aria-label="Snake game board"></canvas>
  <div class="score" aria-live="polite" aria-atomic="true">Score: 0</div>
  <button id="start-btn" aria-label="Start Game">Start Game</button>
  <div class="instructions">Use arrow keys or swipe to move the snake.</div>
</div>

<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const scoreDisplay = document.querySelector('.score');
  const startBtn = document.getElementById('start-btn');
  const toggleThemeBtn = document.querySelector('.toggle-theme');

  const scale = 20; // size of snake segments
  const rows = canvas.height / scale; // 16
  const cols = canvas.width / scale; // 16

  let snake;
  let food;
  let score;
  let speed;
  let direction;
  let gameInterval;

  // Track touch start position for swipe
  let touchStartX = 0;
  let touchStartY = 0;

  class Snake {
    constructor() {
      this.body = [
        { x: Math.floor(cols/2), y: Math.floor(rows/2) }
      ];
      this.dx = 0;
      this.dy = 0;
    }

    setDirection(dx, dy) {
      // Prevent reversing direction
      if (this.body.length > 1) {
        const [head, neck] = [this.body[0], this.body[1]];
        if (head.x + dx === neck.x && head.y + dy === neck.y) {
          return;
        }
      }
      this.dx = dx;
      this.dy = dy;
    }

    update() {
      const head = { x: this.body[0].x + this.dx, y: this.body[0].y + this.dy };

      // Wrap around edges
      if (head.x < 0) head.x = cols -1;
      else if (head.x >= cols) head.x = 0;
      if (head.y < 0) head.y = rows -1;
      else if (head.y >= rows) head.y = 0;

      // Check collision with body
      if (this.body.some(seg => seg.x === head.x && seg.y === head.y)) {
        return false; // collision = game over
      }

      this.body.unshift(head);

      // Eat food?
      if (head.x === food.x && head.y === food.y) {
        score++;
        placeFood();
      } else {
        this.body.pop();
      }

      return true;
    }

    draw(ctx) {
      const snakeColor = document.body.classList.contains('light') 
        ? getComputedStyle(document.body).getPropertyValue('--snake-color-light').trim()
        : getComputedStyle(document.body).getPropertyValue('--snake-color-dark').trim();

      ctx.fillStyle = snakeColor;
      this.body.forEach((seg, i) => {
        ctx.beginPath();
        ctx.rect(seg.x * scale, seg.y * scale, scale, scale);
        ctx.fill();
        // Head highlight
        if(i === 0) {
          ctx.strokeStyle = '#fff';
          ctx.lineWidth = 2;
          ctx.strokeRect(seg.x * scale + 1, seg.y * scale + 1, scale-2, scale-2);
        }
      });
    }
  }

  function placeFood() {
    let x, y;
    do {
      x = Math.floor(Math.random() * cols);
      y = Math.floor(Math.random() * rows);
    } while (snake.body.some(seg => seg.x === x && seg.y === y));
    food = { x, y };
  }

  function drawFood(ctx) {
    const foodColor = document.body.classList.contains('light') 
      ? getComputedStyle(document.body).getPropertyValue('--food-color-light').trim()
      : getComputedStyle(document.body).getPropertyValue('--food-color-dark').trim();

    ctx.fillStyle = foodColor;
    ctx.beginPath();
    ctx.arc(food.x * scale + scale/2, food.y * scale + scale/2, scale/2 - 3, 0, Math.PI * 2);
    ctx.fill();
    ctx.shadowColor = foodColor;
    ctx.shadowBlur = 10;
  }

  function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  function gameLoop() {
    clearCanvas();
    if (!snake.update()) {
      // Game over
      clearInterval(gameInterval);
      startBtn.disabled = false;
      startBtn.textContent = 'Game Over! Click to Restart';
      return;
    }
    snake.draw(ctx);
    drawFood(ctx);
    scoreDisplay.textContent = `Score: ${score}`;
  }

  function startGame() {
    snake = new Snake();
    score = 0;
    direction = null;
    placeFood();
    startBtn.disabled = true;
    startBtn.textContent = 'Game Running...';
    speed = 100; // ms per move

    if (gameInterval) clearInterval(gameInterval);
    gameInterval = setInterval(gameLoop, speed);
  }

  // Keyboard controls
  window.addEventListener('keydown', e => {
    if (!gameInterval) return; // ignore key if not running
    switch (e.key) {
      case 'ArrowUp':
        snake.setDirection(0, -1);
        break;
      case 'ArrowDown':
        snake.setDirection(0, 1);
        break;
      case 'ArrowLeft':
        snake.setDirection(-1, 0);
        break;
      case 'ArrowRight':
        snake.setDirection(1, 0);
        break;
    }
  });

  // Touch controls (swipe detection)
  canvas.addEventListener('touchstart', e => {
    if (e.touches.length === 1) {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    }
  }, { passive: true });

  canvas.addEventListener('touchend', e => {
    if (!gameInterval) return;
    if (e.changedTouches.length !== 1) return;

    const touchEndX = e.changedTouches[0].clientX;
    const touchEndY = e.changedTouches[0].clientY;

    const dx = touchEndX - touchStartX;
    const dy = touchEndY - touchStartY;

    const absDx = Math.abs(dx);
    const absDy = Math.abs(dy);

    if (Math.max(absDx, absDy) > 30) { // threshold to prevent tiny moves
      if (absDx > absDy) {
        // Horizontal swipe
        if (dx > 0) snake.setDirection(1, 0); // right
        else snake.setDirection(-1, 0); // left
      } else {
        // Vertical swipe
        if (dy > 0) snake.setDirection(0, 1); // down
        else snake.setDirection(0, -1); // up
      }
    }
  }, { passive: true });

  startBtn.addEventListener('click', () => {
    startGame();
  });

  toggleThemeBtn.addEventListener('click', () => {
    document.body.classList.toggle('light');
  });

})();
</script>

</body>
</html>
